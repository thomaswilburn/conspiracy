<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Conspiracy</title>
</head>
<body>
  <div class="root"></div>

  <template>
    <div :element="hello">
      Hello <!-- :name -->
      <ul>
        <li :each="item, i of nested.items on data">
          <!-- :name -->
          <a><!-- :item.label --></a>
        </li>
      </ul>
    </div>
    <button :on.click="clickedtestbutton" :on.click.once="clickedonceonly">TEST</button>
    <h1 :if.not="visible">TOGGLE ME <!-- :nested.counter --></h1>
    <h2 :if="visible">I'm different! <!-- :nested.counter --></h2>
  </template>

  <script type="module">
    import { Conspiracy } from "./src/index.js";

    var root = document.querySelector(".root");
    var template = document.querySelector("template").innerHTML.trim();
    var binding = new Conspiracy(template, { unhosted: 0 });
    var data = {
      name: "World",
      nested: {
        counter: 0,
        items: [ { data: 0, label: "A" }, { data: 1, label: "B" }]
      },
    };
    binding.attach(root, data);
    console.log(binding.elements);

    var visible = false;
    document.body.addEventListener("clickedtestbutton", e => {
      console.log(`Got custom event: ${e.type}`);
      data.visible = !data.visible;
      data.nested.counter++;
      data.nested.items.push({ data: data.nested.items.length, label: "ADDED" });
      data.nested.items.push(data.nested.items.shift());
      console.log(data.nested.items);
      binding.update(data);
    });

    document.body.addEventListener("clickedonceonly", e => console.log(e.type));
  </script>
</body>
</html>